'use strict';

const send = require('../../util/ws/send');

// NOTE: Data server symbol may differ from the requested symbol
module.exports = (dsClient, msg) => {
  const { d, candleRequests, candlePromises } = dsClient;
  const [, exID,, tf,, start, end, reqID, candles] = msg;
  const ws = candleRequests[reqID];
  const symbol = reqID.split('-')[1];

  if (!ws) {
    return d('recv candle data for unknown req ID: %s', reqID);
  }

  send(ws, ['data.candles', exID, symbol, tf, start, end, candles]);

  candlePromises[reqID](candles);

  delete candleRequests[reqID];
  delete candlePromises[reqID];
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy93c19jbGllbnRzL2hmX2RzL29uX2RhdGFfY2FuZGxlcy5qcyJdLCJuYW1lcyI6WyJzZW5kIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJkc0NsaWVudCIsIm1zZyIsImQiLCJjYW5kbGVSZXF1ZXN0cyIsImNhbmRsZVByb21pc2VzIiwiZXhJRCIsInRmIiwic3RhcnQiLCJlbmQiLCJyZXFJRCIsImNhbmRsZXMiLCJ3cyIsInN5bWJvbCIsInNwbGl0Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUFwQjs7QUFFQTtBQUNBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUIsQ0FBQ0MsUUFBRCxFQUFXQyxHQUFYLEtBQW1CO0FBQ2xDLFFBQU0sRUFBRUMsQ0FBRixFQUFLQyxjQUFMLEVBQXFCQyxjQUFyQixLQUF3Q0osUUFBOUM7QUFDQSxRQUFNLEdBQUdLLElBQUgsR0FBVUMsRUFBVixHQUFlQyxLQUFmLEVBQXNCQyxHQUF0QixFQUEyQkMsS0FBM0IsRUFBa0NDLE9BQWxDLElBQTZDVCxHQUFuRDtBQUNBLFFBQU1VLEVBQUUsR0FBR1IsY0FBYyxDQUFDTSxLQUFELENBQXpCO0FBQ0EsUUFBTUcsTUFBTSxHQUFHSCxLQUFLLENBQUNJLEtBQU4sQ0FBWSxHQUFaLEVBQWlCLENBQWpCLENBQWY7O0FBRUEsTUFBSSxDQUFDRixFQUFMLEVBQVM7QUFDUCxXQUFPVCxDQUFDLENBQUMseUNBQUQsRUFBNENPLEtBQTVDLENBQVI7QUFDRDs7QUFFRGIsRUFBQUEsSUFBSSxDQUFDZSxFQUFELEVBQUssQ0FBQyxjQUFELEVBQWlCTixJQUFqQixFQUF1Qk8sTUFBdkIsRUFBK0JOLEVBQS9CLEVBQW1DQyxLQUFuQyxFQUEwQ0MsR0FBMUMsRUFBK0NFLE9BQS9DLENBQUwsQ0FBSjs7QUFFQU4sRUFBQUEsY0FBYyxDQUFDSyxLQUFELENBQWQsQ0FBc0JDLE9BQXRCOztBQUVBLFNBQU9QLGNBQWMsQ0FBQ00sS0FBRCxDQUFyQjtBQUNBLFNBQU9MLGNBQWMsQ0FBQ0ssS0FBRCxDQUFyQjtBQUNELENBaEJEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IHNlbmQgPSByZXF1aXJlKCcuLi8uLi91dGlsL3dzL3NlbmQnKVxuXG4vLyBOT1RFOiBEYXRhIHNlcnZlciBzeW1ib2wgbWF5IGRpZmZlciBmcm9tIHRoZSByZXF1ZXN0ZWQgc3ltYm9sXG5tb2R1bGUuZXhwb3J0cyA9IChkc0NsaWVudCwgbXNnKSA9PiB7XG4gIGNvbnN0IHsgZCwgY2FuZGxlUmVxdWVzdHMsIGNhbmRsZVByb21pc2VzIH0gPSBkc0NsaWVudFxuICBjb25zdCBbLCBleElELCwgdGYsLCBzdGFydCwgZW5kLCByZXFJRCwgY2FuZGxlc10gPSBtc2dcbiAgY29uc3Qgd3MgPSBjYW5kbGVSZXF1ZXN0c1tyZXFJRF1cbiAgY29uc3Qgc3ltYm9sID0gcmVxSUQuc3BsaXQoJy0nKVsxXVxuXG4gIGlmICghd3MpIHtcbiAgICByZXR1cm4gZCgncmVjdiBjYW5kbGUgZGF0YSBmb3IgdW5rbm93biByZXEgSUQ6ICVzJywgcmVxSUQpXG4gIH1cblxuICBzZW5kKHdzLCBbJ2RhdGEuY2FuZGxlcycsIGV4SUQsIHN5bWJvbCwgdGYsIHN0YXJ0LCBlbmQsIGNhbmRsZXNdKVxuXG4gIGNhbmRsZVByb21pc2VzW3JlcUlEXShjYW5kbGVzKVxuXG4gIGRlbGV0ZSBjYW5kbGVSZXF1ZXN0c1tyZXFJRF1cbiAgZGVsZXRlIGNhbmRsZVByb21pc2VzW3JlcUlEXVxufVxuIl19