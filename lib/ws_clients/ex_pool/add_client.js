'use strict';

const _isObject = require('lodash/isObject');
const chanDataToKey = require('../../util/chan_data_to_key');

module.exports = (poolClient, exID, chanDataOrID, ws) => {
  const { d, clients } = poolClient;
  const key = _isObject(chanDataOrID) ?
  chanDataToKey(chanDataOrID) :
  `${chanDataOrID}`;

  if (!clients[exID]) clients[exID] = {};
  if (!clients[exID][key]) clients[exID][key] = {};
  if (clients[exID][key][ws.id]) return;

  d('added pool client %s to %s %s', ws.id, exID, key);
  clients[exID][key][ws.id] = ws;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy93c19jbGllbnRzL2V4X3Bvb2wvYWRkX2NsaWVudC5qcyJdLCJuYW1lcyI6WyJfaXNPYmplY3QiLCJyZXF1aXJlIiwiY2hhbkRhdGFUb0tleSIsIm1vZHVsZSIsImV4cG9ydHMiLCJwb29sQ2xpZW50IiwiZXhJRCIsImNoYW5EYXRhT3JJRCIsIndzIiwiZCIsImNsaWVudHMiLCJrZXkiLCJpZCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsU0FBUyxHQUFHQyxPQUFPLENBQUMsaUJBQUQsQ0FBekI7QUFDQSxNQUFNQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyw2QkFBRCxDQUE3Qjs7QUFFQUUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLENBQUNDLFVBQUQsRUFBYUMsSUFBYixFQUFtQkMsWUFBbkIsRUFBaUNDLEVBQWpDLEtBQXdDO0FBQ3ZELFFBQU0sRUFBRUMsQ0FBRixFQUFLQyxPQUFMLEtBQWlCTCxVQUF2QjtBQUNBLFFBQU1NLEdBQUcsR0FBR1gsU0FBUyxDQUFDTyxZQUFELENBQVQ7QUFDUkwsRUFBQUEsYUFBYSxDQUFDSyxZQUFELENBREw7QUFFUCxLQUFFQSxZQUFhLEVBRnBCOztBQUlBLE1BQUksQ0FBQ0csT0FBTyxDQUFDSixJQUFELENBQVosRUFBb0JJLE9BQU8sQ0FBQ0osSUFBRCxDQUFQLEdBQWdCLEVBQWhCO0FBQ3BCLE1BQUksQ0FBQ0ksT0FBTyxDQUFDSixJQUFELENBQVAsQ0FBY0ssR0FBZCxDQUFMLEVBQXlCRCxPQUFPLENBQUNKLElBQUQsQ0FBUCxDQUFjSyxHQUFkLElBQXFCLEVBQXJCO0FBQ3pCLE1BQUlELE9BQU8sQ0FBQ0osSUFBRCxDQUFQLENBQWNLLEdBQWQsRUFBbUJILEVBQUUsQ0FBQ0ksRUFBdEIsQ0FBSixFQUErQjs7QUFFL0JILEVBQUFBLENBQUMsQ0FBQywrQkFBRCxFQUFrQ0QsRUFBRSxDQUFDSSxFQUFyQyxFQUF5Q04sSUFBekMsRUFBK0NLLEdBQS9DLENBQUQ7QUFDQUQsRUFBQUEsT0FBTyxDQUFDSixJQUFELENBQVAsQ0FBY0ssR0FBZCxFQUFtQkgsRUFBRSxDQUFDSSxFQUF0QixJQUE0QkosRUFBNUI7QUFDRCxDQVpEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IF9pc09iamVjdCA9IHJlcXVpcmUoJ2xvZGFzaC9pc09iamVjdCcpXG5jb25zdCBjaGFuRGF0YVRvS2V5ID0gcmVxdWlyZSgnLi4vLi4vdXRpbC9jaGFuX2RhdGFfdG9fa2V5JylcblxubW9kdWxlLmV4cG9ydHMgPSAocG9vbENsaWVudCwgZXhJRCwgY2hhbkRhdGFPcklELCB3cykgPT4ge1xuICBjb25zdCB7IGQsIGNsaWVudHMgfSA9IHBvb2xDbGllbnRcbiAgY29uc3Qga2V5ID0gX2lzT2JqZWN0KGNoYW5EYXRhT3JJRClcbiAgICA/IGNoYW5EYXRhVG9LZXkoY2hhbkRhdGFPcklEKVxuICAgIDogYCR7Y2hhbkRhdGFPcklEfWBcblxuICBpZiAoIWNsaWVudHNbZXhJRF0pIGNsaWVudHNbZXhJRF0gPSB7fVxuICBpZiAoIWNsaWVudHNbZXhJRF1ba2V5XSkgY2xpZW50c1tleElEXVtrZXldID0ge31cbiAgaWYgKGNsaWVudHNbZXhJRF1ba2V5XVt3cy5pZF0pIHJldHVyblxuXG4gIGQoJ2FkZGVkIHBvb2wgY2xpZW50ICVzIHRvICVzICVzJywgd3MuaWQsIGV4SUQsIGtleSlcbiAgY2xpZW50c1tleElEXVtrZXldW3dzLmlkXSA9IHdzXG59XG4iXX0=