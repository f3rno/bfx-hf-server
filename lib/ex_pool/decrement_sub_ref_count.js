'use strict';

const _isFinite = require('lodash/isFinite');
const capture = require('../capture');

module.exports = (pool, exID, chanKey) => {
  const { subscriptions } = pool;

  if (!subscriptions[exID]) return;
  if (!_isFinite(subscriptions[exID][chanKey])) return;

  subscriptions[exID][chanKey] -= 1;

  if (subscriptions[exID][chanKey] < 0) {
    capture.exception('error: sub ref count below 0 for %s %s', exID, chanKey);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9leF9wb29sL2RlY3JlbWVudF9zdWJfcmVmX2NvdW50LmpzIl0sIm5hbWVzIjpbIl9pc0Zpbml0ZSIsInJlcXVpcmUiLCJjYXB0dXJlIiwibW9kdWxlIiwiZXhwb3J0cyIsInBvb2wiLCJleElEIiwiY2hhbktleSIsInN1YnNjcmlwdGlvbnMiLCJleGNlcHRpb24iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLFNBQVMsR0FBR0MsT0FBTyxDQUFDLGlCQUFELENBQXpCO0FBQ0EsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFFQUUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLENBQUNDLElBQUQsRUFBT0MsSUFBUCxFQUFhQyxPQUFiLEtBQXlCO0FBQ3hDLFFBQU0sRUFBRUMsYUFBRixLQUFvQkgsSUFBMUI7O0FBRUEsTUFBSSxDQUFDRyxhQUFhLENBQUNGLElBQUQsQ0FBbEIsRUFBMEI7QUFDMUIsTUFBSSxDQUFDTixTQUFTLENBQUNRLGFBQWEsQ0FBQ0YsSUFBRCxDQUFiLENBQW9CQyxPQUFwQixDQUFELENBQWQsRUFBOEM7O0FBRTlDQyxFQUFBQSxhQUFhLENBQUNGLElBQUQsQ0FBYixDQUFvQkMsT0FBcEIsS0FBZ0MsQ0FBaEM7O0FBRUEsTUFBSUMsYUFBYSxDQUFDRixJQUFELENBQWIsQ0FBb0JDLE9BQXBCLElBQStCLENBQW5DLEVBQXNDO0FBQ3BDTCxJQUFBQSxPQUFPLENBQUNPLFNBQVIsQ0FBa0Isd0NBQWxCLEVBQTRESCxJQUE1RCxFQUFrRUMsT0FBbEU7QUFDRDtBQUNGLENBWEQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgX2lzRmluaXRlID0gcmVxdWlyZSgnbG9kYXNoL2lzRmluaXRlJylcbmNvbnN0IGNhcHR1cmUgPSByZXF1aXJlKCcuLi9jYXB0dXJlJylcblxubW9kdWxlLmV4cG9ydHMgPSAocG9vbCwgZXhJRCwgY2hhbktleSkgPT4ge1xuICBjb25zdCB7IHN1YnNjcmlwdGlvbnMgfSA9IHBvb2xcblxuICBpZiAoIXN1YnNjcmlwdGlvbnNbZXhJRF0pIHJldHVyblxuICBpZiAoIV9pc0Zpbml0ZShzdWJzY3JpcHRpb25zW2V4SURdW2NoYW5LZXldKSkgcmV0dXJuXG5cbiAgc3Vic2NyaXB0aW9uc1tleElEXVtjaGFuS2V5XSAtPSAxXG5cbiAgaWYgKHN1YnNjcmlwdGlvbnNbZXhJRF1bY2hhbktleV0gPCAwKSB7XG4gICAgY2FwdHVyZS5leGNlcHRpb24oJ2Vycm9yOiBzdWIgcmVmIGNvdW50IGJlbG93IDAgZm9yICVzICVzJywgZXhJRCwgY2hhbktleSlcbiAgfVxufVxuIl19