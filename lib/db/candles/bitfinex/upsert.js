'use strict';

const dbRL = require('../../pg_rate_limited');
const tfToString = require('../../../exchange_clients/bitfinex/util/tf_to_string');
const upsert = require('../../pg/upsert');

module.exports = async (symbol, tf, c) => {
  return dbRL(async db => {
    return upsert({
      db,
      path: `bitfinex_candles_${tfToString(tf)}`,
      index: 'key',
      indexMatches: ['key'],
      doc: {
        symbol,
        mts: `${c.mts}`,
        open: `${c.open}`,
        close: `${c.close}`,
        high: `${c.high}`,
        low: `${c.low}`,
        volume: `${c.volume}`,
        key: `${symbol}-${c.mts}` } });


  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9kYi9jYW5kbGVzL2JpdGZpbmV4L3Vwc2VydC5qcyJdLCJuYW1lcyI6WyJkYlJMIiwicmVxdWlyZSIsInRmVG9TdHJpbmciLCJ1cHNlcnQiLCJtb2R1bGUiLCJleHBvcnRzIiwic3ltYm9sIiwidGYiLCJjIiwiZGIiLCJwYXRoIiwiaW5kZXgiLCJpbmRleE1hdGNoZXMiLCJkb2MiLCJtdHMiLCJvcGVuIiwiY2xvc2UiLCJoaWdoIiwibG93Iiwidm9sdW1lIiwia2V5Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyx1QkFBRCxDQUFwQjtBQUNBLE1BQU1DLFVBQVUsR0FBR0QsT0FBTyxDQUFDLHNEQUFELENBQTFCO0FBQ0EsTUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMsaUJBQUQsQ0FBdEI7O0FBRUFHLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixPQUFPQyxNQUFQLEVBQWVDLEVBQWYsRUFBbUJDLENBQW5CLEtBQXlCO0FBQ3hDLFNBQU9SLElBQUksQ0FBQyxNQUFPUyxFQUFQLElBQWM7QUFDeEIsV0FBT04sTUFBTSxDQUFDO0FBQ1pNLE1BQUFBLEVBRFk7QUFFWkMsTUFBQUEsSUFBSSxFQUFHLG9CQUFtQlIsVUFBVSxDQUFDSyxFQUFELENBQUssRUFGN0I7QUFHWkksTUFBQUEsS0FBSyxFQUFFLEtBSEs7QUFJWkMsTUFBQUEsWUFBWSxFQUFFLENBQUMsS0FBRCxDQUpGO0FBS1pDLE1BQUFBLEdBQUcsRUFBRTtBQUNIUCxRQUFBQSxNQURHO0FBRUhRLFFBQUFBLEdBQUcsRUFBRyxHQUFFTixDQUFDLENBQUNNLEdBQUksRUFGWDtBQUdIQyxRQUFBQSxJQUFJLEVBQUcsR0FBRVAsQ0FBQyxDQUFDTyxJQUFLLEVBSGI7QUFJSEMsUUFBQUEsS0FBSyxFQUFHLEdBQUVSLENBQUMsQ0FBQ1EsS0FBTSxFQUpmO0FBS0hDLFFBQUFBLElBQUksRUFBRyxHQUFFVCxDQUFDLENBQUNTLElBQUssRUFMYjtBQU1IQyxRQUFBQSxHQUFHLEVBQUcsR0FBRVYsQ0FBQyxDQUFDVSxHQUFJLEVBTlg7QUFPSEMsUUFBQUEsTUFBTSxFQUFHLEdBQUVYLENBQUMsQ0FBQ1csTUFBTyxFQVBqQjtBQVFIQyxRQUFBQSxHQUFHLEVBQUcsR0FBRWQsTUFBTyxJQUFHRSxDQUFDLENBQUNNLEdBQUksRUFSckIsRUFMTyxFQUFELENBQWI7OztBQWdCRCxHQWpCVSxDQUFYO0FBa0JELENBbkJEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IGRiUkwgPSByZXF1aXJlKCcuLi8uLi9wZ19yYXRlX2xpbWl0ZWQnKVxuY29uc3QgdGZUb1N0cmluZyA9IHJlcXVpcmUoJy4uLy4uLy4uL2V4Y2hhbmdlX2NsaWVudHMvYml0ZmluZXgvdXRpbC90Zl90b19zdHJpbmcnKVxuY29uc3QgdXBzZXJ0ID0gcmVxdWlyZSgnLi4vLi4vcGcvdXBzZXJ0JylcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoc3ltYm9sLCB0ZiwgYykgPT4ge1xuICByZXR1cm4gZGJSTChhc3luYyAoZGIpID0+IHtcbiAgICByZXR1cm4gdXBzZXJ0KHtcbiAgICAgIGRiLFxuICAgICAgcGF0aDogYGJpdGZpbmV4X2NhbmRsZXNfJHt0ZlRvU3RyaW5nKHRmKX1gLFxuICAgICAgaW5kZXg6ICdrZXknLFxuICAgICAgaW5kZXhNYXRjaGVzOiBbJ2tleSddLFxuICAgICAgZG9jOiB7XG4gICAgICAgIHN5bWJvbCxcbiAgICAgICAgbXRzOiBgJHtjLm10c31gLFxuICAgICAgICBvcGVuOiBgJHtjLm9wZW59YCxcbiAgICAgICAgY2xvc2U6IGAke2MuY2xvc2V9YCxcbiAgICAgICAgaGlnaDogYCR7Yy5oaWdofWAsXG4gICAgICAgIGxvdzogYCR7Yy5sb3d9YCxcbiAgICAgICAgdm9sdW1lOiBgJHtjLnZvbHVtZX1gLFxuICAgICAgICBrZXk6IGAke3N5bWJvbH0tJHtjLm10c31gXG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cbiJdfQ==