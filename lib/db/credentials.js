'use strict';

const CREDENTIALS_CID = '__hfui__password';

const get = async db => {
  const { Credential } = db;
  return Credential.get(CREDENTIALS_CID);
};

const set = async (db, key, secret) => {
  const { Credential } = db;

  Credential.set({
    cid: CREDENTIALS_CID,
    key,
    secret });

};

const reset = async db => {
  const { Credential } = db;
  await Credential.rmAll();
};

module.exports = { get, set, reset, CREDENTIALS_CID };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kYi9jcmVkZW50aWFscy5qcyJdLCJuYW1lcyI6WyJDUkVERU5USUFMU19DSUQiLCJnZXQiLCJkYiIsIkNyZWRlbnRpYWwiLCJzZXQiLCJrZXkiLCJzZWNyZXQiLCJjaWQiLCJyZXNldCIsInJtQWxsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsZUFBZSxHQUFHLGtCQUF4Qjs7QUFFQSxNQUFNQyxHQUFHLEdBQUcsTUFBT0MsRUFBUCxJQUFjO0FBQ3hCLFFBQU0sRUFBRUMsVUFBRixLQUFpQkQsRUFBdkI7QUFDQSxTQUFPQyxVQUFVLENBQUNGLEdBQVgsQ0FBZUQsZUFBZixDQUFQO0FBQ0QsQ0FIRDs7QUFLQSxNQUFNSSxHQUFHLEdBQUcsT0FBT0YsRUFBUCxFQUFXRyxHQUFYLEVBQWdCQyxNQUFoQixLQUEyQjtBQUNyQyxRQUFNLEVBQUVILFVBQUYsS0FBaUJELEVBQXZCOztBQUVBQyxFQUFBQSxVQUFVLENBQUNDLEdBQVgsQ0FBZTtBQUNiRyxJQUFBQSxHQUFHLEVBQUVQLGVBRFE7QUFFYkssSUFBQUEsR0FGYTtBQUdiQyxJQUFBQSxNQUhhLEVBQWY7O0FBS0QsQ0FSRDs7QUFVQSxNQUFNRSxLQUFLLEdBQUcsTUFBT04sRUFBUCxJQUFjO0FBQzFCLFFBQU0sRUFBRUMsVUFBRixLQUFpQkQsRUFBdkI7QUFDQSxRQUFNQyxVQUFVLENBQUNNLEtBQVgsRUFBTjtBQUNELENBSEQ7O0FBS0FDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixFQUFFVixHQUFGLEVBQU9HLEdBQVAsRUFBWUksS0FBWixFQUFtQlIsZUFBbkIsRUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgQ1JFREVOVElBTFNfQ0lEID0gJ19faGZ1aV9fcGFzc3dvcmQnXG5cbmNvbnN0IGdldCA9IGFzeW5jIChkYikgPT4ge1xuICBjb25zdCB7IENyZWRlbnRpYWwgfSA9IGRiXG4gIHJldHVybiBDcmVkZW50aWFsLmdldChDUkVERU5USUFMU19DSUQpXG59XG5cbmNvbnN0IHNldCA9IGFzeW5jIChkYiwga2V5LCBzZWNyZXQpID0+IHtcbiAgY29uc3QgeyBDcmVkZW50aWFsIH0gPSBkYlxuXG4gIENyZWRlbnRpYWwuc2V0KHtcbiAgICBjaWQ6IENSRURFTlRJQUxTX0NJRCxcbiAgICBrZXksXG4gICAgc2VjcmV0XG4gIH0pXG59XG5cbmNvbnN0IHJlc2V0ID0gYXN5bmMgKGRiKSA9PiB7XG4gIGNvbnN0IHsgQ3JlZGVudGlhbCB9ID0gZGJcbiAgYXdhaXQgQ3JlZGVudGlhbC5ybUFsbCgpXG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXQsIHNldCwgcmVzZXQsIENSRURFTlRJQUxTX0NJRCB9XG4iXX0=