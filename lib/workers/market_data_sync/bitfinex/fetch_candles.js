'use strict';

const { RESTv2 } = require('bfx-api-node-rest');
const PromiseThrottle = require('promise-throttle');

const FETCH_LIMIT = 5000;
const client = new RESTv2();
const pt = new PromiseThrottle({
  requestsPerSecond: 8.0 / 60.0, // taken from docs (10ps)
  promiseImplementation: Promise });


module.exports = async (symbol, tf, start) => {
  return pt.add(client.candles.bind(client, {
    symbol,
    timeframe: tf,
    query: {
      _bfx: 1,
      start,
      limit: FETCH_LIMIT,
      sort: 1 } }));


};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy93b3JrZXJzL21hcmtldF9kYXRhX3N5bmMvYml0ZmluZXgvZmV0Y2hfY2FuZGxlcy5qcyJdLCJuYW1lcyI6WyJSRVNUdjIiLCJyZXF1aXJlIiwiUHJvbWlzZVRocm90dGxlIiwiRkVUQ0hfTElNSVQiLCJjbGllbnQiLCJwdCIsInJlcXVlc3RzUGVyU2Vjb25kIiwicHJvbWlzZUltcGxlbWVudGF0aW9uIiwiUHJvbWlzZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJzeW1ib2wiLCJ0ZiIsInN0YXJ0IiwiYWRkIiwiY2FuZGxlcyIsImJpbmQiLCJ0aW1lZnJhbWUiLCJxdWVyeSIsIl9iZngiLCJsaW1pdCIsInNvcnQiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU0sRUFBRUEsTUFBRixLQUFhQyxPQUFPLENBQUMsbUJBQUQsQ0FBMUI7QUFDQSxNQUFNQyxlQUFlLEdBQUdELE9BQU8sQ0FBQyxrQkFBRCxDQUEvQjs7QUFFQSxNQUFNRSxXQUFXLEdBQUcsSUFBcEI7QUFDQSxNQUFNQyxNQUFNLEdBQUcsSUFBSUosTUFBSixFQUFmO0FBQ0EsTUFBTUssRUFBRSxHQUFHLElBQUlILGVBQUosQ0FBb0I7QUFDN0JJLEVBQUFBLGlCQUFpQixFQUFFLE1BQU0sSUFESSxFQUNFO0FBQy9CQyxFQUFBQSxxQkFBcUIsRUFBRUMsT0FGTSxFQUFwQixDQUFYOzs7QUFLQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLE9BQU9DLE1BQVAsRUFBZUMsRUFBZixFQUFtQkMsS0FBbkIsS0FBNkI7QUFDNUMsU0FBT1IsRUFBRSxDQUFDUyxHQUFILENBQU9WLE1BQU0sQ0FBQ1csT0FBUCxDQUFlQyxJQUFmLENBQW9CWixNQUFwQixFQUE0QjtBQUN4Q08sSUFBQUEsTUFEd0M7QUFFeENNLElBQUFBLFNBQVMsRUFBRUwsRUFGNkI7QUFHeENNLElBQUFBLEtBQUssRUFBRTtBQUNMQyxNQUFBQSxJQUFJLEVBQUUsQ0FERDtBQUVMTixNQUFBQSxLQUZLO0FBR0xPLE1BQUFBLEtBQUssRUFBRWpCLFdBSEY7QUFJTGtCLE1BQUFBLElBQUksRUFBRSxDQUpELEVBSGlDLEVBQTVCLENBQVAsQ0FBUDs7O0FBVUQsQ0FYRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCB7IFJFU1R2MiB9ID0gcmVxdWlyZSgnYmZ4LWFwaS1ub2RlLXJlc3QnKVxuY29uc3QgUHJvbWlzZVRocm90dGxlID0gcmVxdWlyZSgncHJvbWlzZS10aHJvdHRsZScpXG5cbmNvbnN0IEZFVENIX0xJTUlUID0gNTAwMFxuY29uc3QgY2xpZW50ID0gbmV3IFJFU1R2MigpXG5jb25zdCBwdCA9IG5ldyBQcm9taXNlVGhyb3R0bGUoe1xuICByZXF1ZXN0c1BlclNlY29uZDogOC4wIC8gNjAuMCwgLy8gdGFrZW4gZnJvbSBkb2NzICgxMHBzKVxuICBwcm9taXNlSW1wbGVtZW50YXRpb246IFByb21pc2Vcbn0pXG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKHN5bWJvbCwgdGYsIHN0YXJ0KSA9PiB7XG4gIHJldHVybiBwdC5hZGQoY2xpZW50LmNhbmRsZXMuYmluZChjbGllbnQsIHtcbiAgICBzeW1ib2wsXG4gICAgdGltZWZyYW1lOiB0ZixcbiAgICBxdWVyeToge1xuICAgICAgX2JmeDogMSxcbiAgICAgIHN0YXJ0LFxuICAgICAgbGltaXQ6IEZFVENIX0xJTUlULFxuICAgICAgc29ydDogMVxuICAgIH1cbiAgfSkpXG59XG4iXX0=