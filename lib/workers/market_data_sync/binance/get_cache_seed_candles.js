'use strict';

const _reverse = require('lodash/reverse');
const dbRL = require('../../../db/pg_rate_limited');
const tfToString = require('../../../exchange_clients/binance/util/tf_to_string');

module.exports = async (symbol, tf) => {
  const candles = await dbRL(db => {
    return db(`binance_candles_${tfToString(tf)}`).
    where('symbol', symbol).
    orderBy('mts', 'desc').
    limit(5000).
    select('*');
  });

  return _reverse(candles);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy93b3JrZXJzL21hcmtldF9kYXRhX3N5bmMvYmluYW5jZS9nZXRfY2FjaGVfc2VlZF9jYW5kbGVzLmpzIl0sIm5hbWVzIjpbIl9yZXZlcnNlIiwicmVxdWlyZSIsImRiUkwiLCJ0ZlRvU3RyaW5nIiwibW9kdWxlIiwiZXhwb3J0cyIsInN5bWJvbCIsInRmIiwiY2FuZGxlcyIsImRiIiwid2hlcmUiLCJvcmRlckJ5IiwibGltaXQiLCJzZWxlY3QiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQXhCO0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsNkJBQUQsQ0FBcEI7QUFDQSxNQUFNRSxVQUFVLEdBQUdGLE9BQU8sQ0FBQyxxREFBRCxDQUExQjs7QUFFQUcsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLE9BQU9DLE1BQVAsRUFBZUMsRUFBZixLQUFzQjtBQUNyQyxRQUFNQyxPQUFPLEdBQUcsTUFBTU4sSUFBSSxDQUFFTyxFQUFELElBQVE7QUFDakMsV0FBT0EsRUFBRSxDQUFFLG1CQUFrQk4sVUFBVSxDQUFDSSxFQUFELENBQUssRUFBbkMsQ0FBRjtBQUNKRyxJQUFBQSxLQURJLENBQ0UsUUFERixFQUNZSixNQURaO0FBRUpLLElBQUFBLE9BRkksQ0FFSSxLQUZKLEVBRVcsTUFGWDtBQUdKQyxJQUFBQSxLQUhJLENBR0UsSUFIRjtBQUlKQyxJQUFBQSxNQUpJLENBSUcsR0FKSCxDQUFQO0FBS0QsR0FOeUIsQ0FBMUI7O0FBUUEsU0FBT2IsUUFBUSxDQUFDUSxPQUFELENBQWY7QUFDRCxDQVZEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IF9yZXZlcnNlID0gcmVxdWlyZSgnbG9kYXNoL3JldmVyc2UnKVxuY29uc3QgZGJSTCA9IHJlcXVpcmUoJy4uLy4uLy4uL2RiL3BnX3JhdGVfbGltaXRlZCcpXG5jb25zdCB0ZlRvU3RyaW5nID0gcmVxdWlyZSgnLi4vLi4vLi4vZXhjaGFuZ2VfY2xpZW50cy9iaW5hbmNlL3V0aWwvdGZfdG9fc3RyaW5nJylcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoc3ltYm9sLCB0ZikgPT4ge1xuICBjb25zdCBjYW5kbGVzID0gYXdhaXQgZGJSTCgoZGIpID0+IHtcbiAgICByZXR1cm4gZGIoYGJpbmFuY2VfY2FuZGxlc18ke3RmVG9TdHJpbmcodGYpfWApXG4gICAgICAud2hlcmUoJ3N5bWJvbCcsIHN5bWJvbClcbiAgICAgIC5vcmRlckJ5KCdtdHMnLCAnZGVzYycpXG4gICAgICAubGltaXQoNTAwMClcbiAgICAgIC5zZWxlY3QoJyonKVxuICB9KVxuXG4gIHJldHVybiBfcmV2ZXJzZShjYW5kbGVzKVxufVxuIl19