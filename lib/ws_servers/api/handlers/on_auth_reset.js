'use strict';

const send = require('../../../util/ws/send');
const { notifyInfo } = require('../../../util/ws/notify');

module.exports = async (server, ws) => {
  const { d, db } = server;
  const { Credential, Strategy, UserSettings } = db;

  await Credential.rmAll();
  await Strategy.rmAll();
  await UserSettings.rmAll();

  send(ws, ['info.auth_configured', false]);
  send(ws, ['info.auth_token', null]);

  notifyInfo(ws, 'Cleared user credentials & data');
  d('reset user credentials');
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy93c19zZXJ2ZXJzL2FwaS9oYW5kbGVycy9vbl9hdXRoX3Jlc2V0LmpzIl0sIm5hbWVzIjpbInNlbmQiLCJyZXF1aXJlIiwibm90aWZ5SW5mbyIsIm1vZHVsZSIsImV4cG9ydHMiLCJzZXJ2ZXIiLCJ3cyIsImQiLCJkYiIsIkNyZWRlbnRpYWwiLCJTdHJhdGVneSIsIlVzZXJTZXR0aW5ncyIsInJtQWxsIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyx1QkFBRCxDQUFwQjtBQUNBLE1BQU0sRUFBRUMsVUFBRixLQUFpQkQsT0FBTyxDQUFDLHlCQUFELENBQTlCOztBQUVBRSxNQUFNLENBQUNDLE9BQVAsR0FBaUIsT0FBT0MsTUFBUCxFQUFlQyxFQUFmLEtBQXNCO0FBQ3JDLFFBQU0sRUFBRUMsQ0FBRixFQUFLQyxFQUFMLEtBQVlILE1BQWxCO0FBQ0EsUUFBTSxFQUFFSSxVQUFGLEVBQWNDLFFBQWQsRUFBd0JDLFlBQXhCLEtBQXlDSCxFQUEvQzs7QUFFQSxRQUFNQyxVQUFVLENBQUNHLEtBQVgsRUFBTjtBQUNBLFFBQU1GLFFBQVEsQ0FBQ0UsS0FBVCxFQUFOO0FBQ0EsUUFBTUQsWUFBWSxDQUFDQyxLQUFiLEVBQU47O0FBRUFaLEVBQUFBLElBQUksQ0FBQ00sRUFBRCxFQUFLLENBQUMsc0JBQUQsRUFBeUIsS0FBekIsQ0FBTCxDQUFKO0FBQ0FOLEVBQUFBLElBQUksQ0FBQ00sRUFBRCxFQUFLLENBQUMsaUJBQUQsRUFBb0IsSUFBcEIsQ0FBTCxDQUFKOztBQUVBSixFQUFBQSxVQUFVLENBQUNJLEVBQUQsRUFBSyxpQ0FBTCxDQUFWO0FBQ0FDLEVBQUFBLENBQUMsQ0FBQyx3QkFBRCxDQUFEO0FBQ0QsQ0FiRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCBzZW5kID0gcmVxdWlyZSgnLi4vLi4vLi4vdXRpbC93cy9zZW5kJylcbmNvbnN0IHsgbm90aWZ5SW5mbyB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vdXRpbC93cy9ub3RpZnknKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIChzZXJ2ZXIsIHdzKSA9PiB7XG4gIGNvbnN0IHsgZCwgZGIgfSA9IHNlcnZlclxuICBjb25zdCB7IENyZWRlbnRpYWwsIFN0cmF0ZWd5LCBVc2VyU2V0dGluZ3MgfSA9IGRiXG5cbiAgYXdhaXQgQ3JlZGVudGlhbC5ybUFsbCgpXG4gIGF3YWl0IFN0cmF0ZWd5LnJtQWxsKClcbiAgYXdhaXQgVXNlclNldHRpbmdzLnJtQWxsKClcblxuICBzZW5kKHdzLCBbJ2luZm8uYXV0aF9jb25maWd1cmVkJywgZmFsc2VdKVxuICBzZW5kKHdzLCBbJ2luZm8uYXV0aF90b2tlbicsIG51bGxdKVxuXG4gIG5vdGlmeUluZm8od3MsICdDbGVhcmVkIHVzZXIgY3JlZGVudGlhbHMgJiBkYXRhJylcbiAgZCgncmVzZXQgdXNlciBjcmVkZW50aWFscycpXG59XG4iXX0=