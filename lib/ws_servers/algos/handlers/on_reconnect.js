'use strict';

const { _default: DEFAULT_SETTINGS } = require('bfx-hf-ui-config').UserSettings;

module.exports = async (server, ws) => {
  const { d, apiDB } = server;
  const { UserSettings } = apiDB;
  const { userSettings: settings } = await UserSettings.getAll();
  const { dms } = settings || DEFAULT_SETTINGS;
  const hosts = Object.keys(server.hosts);

  hosts.forEach(k => {
    const h = server.hosts[k];
    const adapter = h.getAdapter();

    if (adapter.updateAuthArgs) {
      adapter.updateAuthArgs({ dms: dms ? 4 : 0 });
    }

    h.reconnect();

    d('issued reconnect for %s [dms %s]', k, dms);
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy93c19zZXJ2ZXJzL2FsZ29zL2hhbmRsZXJzL29uX3JlY29ubmVjdC5qcyJdLCJuYW1lcyI6WyJfZGVmYXVsdCIsIkRFRkFVTFRfU0VUVElOR1MiLCJyZXF1aXJlIiwiVXNlclNldHRpbmdzIiwibW9kdWxlIiwiZXhwb3J0cyIsInNlcnZlciIsIndzIiwiZCIsImFwaURCIiwidXNlclNldHRpbmdzIiwic2V0dGluZ3MiLCJnZXRBbGwiLCJkbXMiLCJob3N0cyIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwiayIsImgiLCJhZGFwdGVyIiwiZ2V0QWRhcHRlciIsInVwZGF0ZUF1dGhBcmdzIiwicmVjb25uZWN0Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNLEVBQUVBLFFBQVEsRUFBRUMsZ0JBQVosS0FBaUNDLE9BQU8sQ0FBQyxrQkFBRCxDQUFQLENBQTRCQyxZQUFuRTs7QUFFQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLE9BQU9DLE1BQVAsRUFBZUMsRUFBZixLQUFzQjtBQUNyQyxRQUFNLEVBQUVDLENBQUYsRUFBS0MsS0FBTCxLQUFlSCxNQUFyQjtBQUNBLFFBQU0sRUFBRUgsWUFBRixLQUFtQk0sS0FBekI7QUFDQSxRQUFNLEVBQUVDLFlBQVksRUFBRUMsUUFBaEIsS0FBNkIsTUFBTVIsWUFBWSxDQUFDUyxNQUFiLEVBQXpDO0FBQ0EsUUFBTSxFQUFFQyxHQUFGLEtBQVVGLFFBQVEsSUFBSVYsZ0JBQTVCO0FBQ0EsUUFBTWEsS0FBSyxHQUFHQyxNQUFNLENBQUNDLElBQVAsQ0FBWVYsTUFBTSxDQUFDUSxLQUFuQixDQUFkOztBQUVBQSxFQUFBQSxLQUFLLENBQUNHLE9BQU4sQ0FBY0MsQ0FBQyxJQUFJO0FBQ2pCLFVBQU1DLENBQUMsR0FBR2IsTUFBTSxDQUFDUSxLQUFQLENBQWFJLENBQWIsQ0FBVjtBQUNBLFVBQU1FLE9BQU8sR0FBR0QsQ0FBQyxDQUFDRSxVQUFGLEVBQWhCOztBQUVBLFFBQUlELE9BQU8sQ0FBQ0UsY0FBWixFQUE0QjtBQUMxQkYsTUFBQUEsT0FBTyxDQUFDRSxjQUFSLENBQXVCLEVBQUVULEdBQUcsRUFBRUEsR0FBRyxHQUFHLENBQUgsR0FBTyxDQUFqQixFQUF2QjtBQUNEOztBQUVETSxJQUFBQSxDQUFDLENBQUNJLFNBQUY7O0FBRUFmLElBQUFBLENBQUMsQ0FBQyxrQ0FBRCxFQUFxQ1UsQ0FBckMsRUFBd0NMLEdBQXhDLENBQUQ7QUFDRCxHQVhEO0FBWUQsQ0FuQkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgeyBfZGVmYXVsdDogREVGQVVMVF9TRVRUSU5HUyB9ID0gcmVxdWlyZSgnYmZ4LWhmLXVpLWNvbmZpZycpLlVzZXJTZXR0aW5nc1xuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIChzZXJ2ZXIsIHdzKSA9PiB7XG4gIGNvbnN0IHsgZCwgYXBpREIgfSA9IHNlcnZlclxuICBjb25zdCB7IFVzZXJTZXR0aW5ncyB9ID0gYXBpREJcbiAgY29uc3QgeyB1c2VyU2V0dGluZ3M6IHNldHRpbmdzIH0gPSBhd2FpdCBVc2VyU2V0dGluZ3MuZ2V0QWxsKClcbiAgY29uc3QgeyBkbXMgfSA9IHNldHRpbmdzIHx8IERFRkFVTFRfU0VUVElOR1NcbiAgY29uc3QgaG9zdHMgPSBPYmplY3Qua2V5cyhzZXJ2ZXIuaG9zdHMpXG5cbiAgaG9zdHMuZm9yRWFjaChrID0+IHtcbiAgICBjb25zdCBoID0gc2VydmVyLmhvc3RzW2tdXG4gICAgY29uc3QgYWRhcHRlciA9IGguZ2V0QWRhcHRlcigpXG5cbiAgICBpZiAoYWRhcHRlci51cGRhdGVBdXRoQXJncykge1xuICAgICAgYWRhcHRlci51cGRhdGVBdXRoQXJncyh7IGRtczogZG1zID8gNCA6IDAgfSlcbiAgICB9XG5cbiAgICBoLnJlY29ubmVjdCgpXG5cbiAgICBkKCdpc3N1ZWQgcmVjb25uZWN0IGZvciAlcyBbZG1zICVzXScsIGssIGRtcylcbiAgfSlcbn1cbiJdfQ==