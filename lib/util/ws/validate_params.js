'use strict';

const _isBoolean = require('lodash/isBoolean');
const _isObject = require('lodash/isObject');
const _isString = require('lodash/isString');
const _isFinite = require('lodash/isFinite');
const _isEmpty = require('lodash/isEmpty');
const sendError = require('./send_error');

const validators = {
  object: v => _isObject(v) && !_isEmpty(v),
  string: v => _isString(v) && !_isEmpty(v),
  number: _isFinite,
  bool: _isBoolean };


module.exports = (ws, params) => {
  const paramNames = Object.keys(params);
  let param;

  for (let i = 0; i < paramNames.length; i += 1) {
    param = params[paramNames[i]];

    if (!validators[param.type]) {
      throw new Error(`invalid param type: ${param.type}`);
    }

    if (!validators[param.type](param.v)) {
      sendError(ws, `invalid parameter: ${paramNames[i]}`);
      return false;
    }
  }

  return true;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlsL3dzL3ZhbGlkYXRlX3BhcmFtcy5qcyJdLCJuYW1lcyI6WyJfaXNCb29sZWFuIiwicmVxdWlyZSIsIl9pc09iamVjdCIsIl9pc1N0cmluZyIsIl9pc0Zpbml0ZSIsIl9pc0VtcHR5Iiwic2VuZEVycm9yIiwidmFsaWRhdG9ycyIsIm9iamVjdCIsInYiLCJzdHJpbmciLCJudW1iZXIiLCJib29sIiwibW9kdWxlIiwiZXhwb3J0cyIsIndzIiwicGFyYW1zIiwicGFyYW1OYW1lcyIsIk9iamVjdCIsImtleXMiLCJwYXJhbSIsImkiLCJsZW5ndGgiLCJ0eXBlIiwiRXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGtCQUFELENBQTFCO0FBQ0EsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUMsaUJBQUQsQ0FBekI7QUFDQSxNQUFNRSxTQUFTLEdBQUdGLE9BQU8sQ0FBQyxpQkFBRCxDQUF6QjtBQUNBLE1BQU1HLFNBQVMsR0FBR0gsT0FBTyxDQUFDLGlCQUFELENBQXpCO0FBQ0EsTUFBTUksUUFBUSxHQUFHSixPQUFPLENBQUMsZ0JBQUQsQ0FBeEI7QUFDQSxNQUFNSyxTQUFTLEdBQUdMLE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUVBLE1BQU1NLFVBQVUsR0FBRztBQUNqQkMsRUFBQUEsTUFBTSxFQUFFQyxDQUFDLElBQUlQLFNBQVMsQ0FBQ08sQ0FBRCxDQUFULElBQWdCLENBQUNKLFFBQVEsQ0FBQ0ksQ0FBRCxDQURyQjtBQUVqQkMsRUFBQUEsTUFBTSxFQUFFRCxDQUFDLElBQUlOLFNBQVMsQ0FBQ00sQ0FBRCxDQUFULElBQWdCLENBQUNKLFFBQVEsQ0FBQ0ksQ0FBRCxDQUZyQjtBQUdqQkUsRUFBQUEsTUFBTSxFQUFFUCxTQUhTO0FBSWpCUSxFQUFBQSxJQUFJLEVBQUVaLFVBSlcsRUFBbkI7OztBQU9BYSxNQUFNLENBQUNDLE9BQVAsR0FBaUIsQ0FBQ0MsRUFBRCxFQUFLQyxNQUFMLEtBQWdCO0FBQy9CLFFBQU1DLFVBQVUsR0FBR0MsTUFBTSxDQUFDQyxJQUFQLENBQVlILE1BQVosQ0FBbkI7QUFDQSxNQUFJSSxLQUFKOztBQUVBLE9BQUssSUFBSUMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR0osVUFBVSxDQUFDSyxNQUEvQixFQUF1Q0QsQ0FBQyxJQUFJLENBQTVDLEVBQStDO0FBQzdDRCxJQUFBQSxLQUFLLEdBQUdKLE1BQU0sQ0FBQ0MsVUFBVSxDQUFDSSxDQUFELENBQVgsQ0FBZDs7QUFFQSxRQUFJLENBQUNkLFVBQVUsQ0FBQ2EsS0FBSyxDQUFDRyxJQUFQLENBQWYsRUFBNkI7QUFDM0IsWUFBTSxJQUFJQyxLQUFKLENBQVcsdUJBQXNCSixLQUFLLENBQUNHLElBQUssRUFBNUMsQ0FBTjtBQUNEOztBQUVELFFBQUksQ0FBQ2hCLFVBQVUsQ0FBQ2EsS0FBSyxDQUFDRyxJQUFQLENBQVYsQ0FBdUJILEtBQUssQ0FBQ1gsQ0FBN0IsQ0FBTCxFQUFzQztBQUNwQ0gsTUFBQUEsU0FBUyxDQUFDUyxFQUFELEVBQU0sc0JBQXFCRSxVQUFVLENBQUNJLENBQUQsQ0FBSSxFQUF6QyxDQUFUO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPLElBQVA7QUFDRCxDQWxCRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCBfaXNCb29sZWFuID0gcmVxdWlyZSgnbG9kYXNoL2lzQm9vbGVhbicpXG5jb25zdCBfaXNPYmplY3QgPSByZXF1aXJlKCdsb2Rhc2gvaXNPYmplY3QnKVxuY29uc3QgX2lzU3RyaW5nID0gcmVxdWlyZSgnbG9kYXNoL2lzU3RyaW5nJylcbmNvbnN0IF9pc0Zpbml0ZSA9IHJlcXVpcmUoJ2xvZGFzaC9pc0Zpbml0ZScpXG5jb25zdCBfaXNFbXB0eSA9IHJlcXVpcmUoJ2xvZGFzaC9pc0VtcHR5JylcbmNvbnN0IHNlbmRFcnJvciA9IHJlcXVpcmUoJy4vc2VuZF9lcnJvcicpXG5cbmNvbnN0IHZhbGlkYXRvcnMgPSB7XG4gIG9iamVjdDogdiA9PiBfaXNPYmplY3QodikgJiYgIV9pc0VtcHR5KHYpLFxuICBzdHJpbmc6IHYgPT4gX2lzU3RyaW5nKHYpICYmICFfaXNFbXB0eSh2KSxcbiAgbnVtYmVyOiBfaXNGaW5pdGUsXG4gIGJvb2w6IF9pc0Jvb2xlYW5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSAod3MsIHBhcmFtcykgPT4ge1xuICBjb25zdCBwYXJhbU5hbWVzID0gT2JqZWN0LmtleXMocGFyYW1zKVxuICBsZXQgcGFyYW1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtTmFtZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBwYXJhbSA9IHBhcmFtc1twYXJhbU5hbWVzW2ldXVxuXG4gICAgaWYgKCF2YWxpZGF0b3JzW3BhcmFtLnR5cGVdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgcGFyYW0gdHlwZTogJHtwYXJhbS50eXBlfWApXG4gICAgfVxuXG4gICAgaWYgKCF2YWxpZGF0b3JzW3BhcmFtLnR5cGVdKHBhcmFtLnYpKSB7XG4gICAgICBzZW5kRXJyb3Iod3MsIGBpbnZhbGlkIHBhcmFtZXRlcjogJHtwYXJhbU5hbWVzW2ldfWApXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZVxufVxuIl19