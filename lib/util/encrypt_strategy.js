'use strict';

const AES = require('aes-js');
const genAESKey = require('./gen_aes_key');

module.exports = async (strategy, password) => {
  const {
    id, label, defineIndicators, onPriceUpdate, onEnter, onUpdate, onUpdateLong,
    onUpdateShort, onUpdateClosing, onPositionOpen, onPositionUpdate,
    onPositionClose, onStart, onStop } =
  strategy;

  const aesKey = await genAESKey(password);
  const aesCTR = new AES.ModeOfOperation.ctr(aesKey); // eslint-disable-line

  const labelBytes = AES.utils.utf8.toBytes(label || '');
  const defineIndicatorsBytes = AES.utils.utf8.toBytes(defineIndicators || '');
  const onPriceUpdateBytes = AES.utils.utf8.toBytes(onPriceUpdate || '');
  const onEnterBytes = AES.utils.utf8.toBytes(onEnter || '');
  const onUpdateBytes = AES.utils.utf8.toBytes(onUpdate || '');
  const onUpdateLongBytes = AES.utils.utf8.toBytes(onUpdateLong || '');
  const onUpdateShortBytes = AES.utils.utf8.toBytes(onUpdateShort || '');
  const onUpdateClosingBytes = AES.utils.utf8.toBytes(onUpdateClosing || '');
  const onPositionOpenBytes = AES.utils.utf8.toBytes(onPositionOpen || '');
  const onPositionUpdateBytes = AES.utils.utf8.toBytes(onPositionUpdate || '');
  const onPositionCloseBytes = AES.utils.utf8.toBytes(onPositionClose || '');
  const onStartBytes = AES.utils.utf8.toBytes(onStart || '');
  const onStopBytes = AES.utils.utf8.toBytes(onStop || '');

  const labelCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(labelBytes));
  const defineIndicatorsCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(defineIndicatorsBytes));
  const onPriceUpdateCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onPriceUpdateBytes));
  const onEnterCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onEnterBytes));
  const onUpdateCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onUpdateBytes));
  const onUpdateLongCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onUpdateLongBytes));
  const onUpdateShortCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onUpdateShortBytes));
  const onUpdateClosingCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onUpdateClosingBytes));
  const onPositionOpenCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onPositionOpenBytes));
  const onPositionUpdateCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onPositionUpdateBytes));
  const onPositionCloseCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onPositionCloseBytes));
  const onStartCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onStartBytes));
  const onStopCipherText = AES.utils.hex.fromBytes(aesCTR.encrypt(onStopBytes));

  return {
    id,
    label,
    cryptedLabel: labelCipherText,

    defineIndicators: defineIndicatorsCipherText,
    onPriceUpdate: onPriceUpdateCipherText,
    onEnter: onEnterCipherText,
    onUpdate: onUpdateCipherText,
    onUpdateLong: onUpdateLongCipherText,
    onUpdateShort: onUpdateShortCipherText,
    onUpdateClosing: onUpdateClosingCipherText,
    onPositionOpen: onPositionOpenCipherText,
    onPositionUpdate: onPositionUpdateCipherText,
    onPositionClose: onPositionCloseCipherText,
    onStart: onStartCipherText,
    onStop: onStopCipherText };

};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2VuY3J5cHRfc3RyYXRlZ3kuanMiXSwibmFtZXMiOlsiQUVTIiwicmVxdWlyZSIsImdlbkFFU0tleSIsIm1vZHVsZSIsImV4cG9ydHMiLCJzdHJhdGVneSIsInBhc3N3b3JkIiwiaWQiLCJsYWJlbCIsImRlZmluZUluZGljYXRvcnMiLCJvblByaWNlVXBkYXRlIiwib25FbnRlciIsIm9uVXBkYXRlIiwib25VcGRhdGVMb25nIiwib25VcGRhdGVTaG9ydCIsIm9uVXBkYXRlQ2xvc2luZyIsIm9uUG9zaXRpb25PcGVuIiwib25Qb3NpdGlvblVwZGF0ZSIsIm9uUG9zaXRpb25DbG9zZSIsIm9uU3RhcnQiLCJvblN0b3AiLCJhZXNLZXkiLCJhZXNDVFIiLCJNb2RlT2ZPcGVyYXRpb24iLCJjdHIiLCJsYWJlbEJ5dGVzIiwidXRpbHMiLCJ1dGY4IiwidG9CeXRlcyIsImRlZmluZUluZGljYXRvcnNCeXRlcyIsIm9uUHJpY2VVcGRhdGVCeXRlcyIsIm9uRW50ZXJCeXRlcyIsIm9uVXBkYXRlQnl0ZXMiLCJvblVwZGF0ZUxvbmdCeXRlcyIsIm9uVXBkYXRlU2hvcnRCeXRlcyIsIm9uVXBkYXRlQ2xvc2luZ0J5dGVzIiwib25Qb3NpdGlvbk9wZW5CeXRlcyIsIm9uUG9zaXRpb25VcGRhdGVCeXRlcyIsIm9uUG9zaXRpb25DbG9zZUJ5dGVzIiwib25TdGFydEJ5dGVzIiwib25TdG9wQnl0ZXMiLCJsYWJlbENpcGhlclRleHQiLCJoZXgiLCJmcm9tQnl0ZXMiLCJlbmNyeXB0IiwiZGVmaW5lSW5kaWNhdG9yc0NpcGhlclRleHQiLCJvblByaWNlVXBkYXRlQ2lwaGVyVGV4dCIsIm9uRW50ZXJDaXBoZXJUZXh0Iiwib25VcGRhdGVDaXBoZXJUZXh0Iiwib25VcGRhdGVMb25nQ2lwaGVyVGV4dCIsIm9uVXBkYXRlU2hvcnRDaXBoZXJUZXh0Iiwib25VcGRhdGVDbG9zaW5nQ2lwaGVyVGV4dCIsIm9uUG9zaXRpb25PcGVuQ2lwaGVyVGV4dCIsIm9uUG9zaXRpb25VcGRhdGVDaXBoZXJUZXh0Iiwib25Qb3NpdGlvbkNsb3NlQ2lwaGVyVGV4dCIsIm9uU3RhcnRDaXBoZXJUZXh0Iiwib25TdG9wQ2lwaGVyVGV4dCIsImNyeXB0ZWRMYWJlbCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFuQjtBQUNBLE1BQU1DLFNBQVMsR0FBR0QsT0FBTyxDQUFDLGVBQUQsQ0FBekI7O0FBRUFFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixPQUFPQyxRQUFQLEVBQWlCQyxRQUFqQixLQUE4QjtBQUM3QyxRQUFNO0FBQ0pDLElBQUFBLEVBREksRUFDQUMsS0FEQSxFQUNPQyxnQkFEUCxFQUN5QkMsYUFEekIsRUFDd0NDLE9BRHhDLEVBQ2lEQyxRQURqRCxFQUMyREMsWUFEM0Q7QUFFSkMsSUFBQUEsYUFGSSxFQUVXQyxlQUZYLEVBRTRCQyxjQUY1QixFQUU0Q0MsZ0JBRjVDO0FBR0pDLElBQUFBLGVBSEksRUFHYUMsT0FIYixFQUdzQkMsTUFIdEI7QUFJRmYsRUFBQUEsUUFKSjs7QUFNQSxRQUFNZ0IsTUFBTSxHQUFHLE1BQU1uQixTQUFTLENBQUNJLFFBQUQsQ0FBOUI7QUFDQSxRQUFNZ0IsTUFBTSxHQUFHLElBQUl0QixHQUFHLENBQUN1QixlQUFKLENBQW9CQyxHQUF4QixDQUE0QkgsTUFBNUIsQ0FBZixDQVI2QyxDQVFNOztBQUVuRCxRQUFNSSxVQUFVLEdBQUd6QixHQUFHLENBQUMwQixLQUFKLENBQVVDLElBQVYsQ0FBZUMsT0FBZixDQUF1QnBCLEtBQUssSUFBSSxFQUFoQyxDQUFuQjtBQUNBLFFBQU1xQixxQkFBcUIsR0FBRzdCLEdBQUcsQ0FBQzBCLEtBQUosQ0FBVUMsSUFBVixDQUFlQyxPQUFmLENBQXVCbkIsZ0JBQWdCLElBQUksRUFBM0MsQ0FBOUI7QUFDQSxRQUFNcUIsa0JBQWtCLEdBQUc5QixHQUFHLENBQUMwQixLQUFKLENBQVVDLElBQVYsQ0FBZUMsT0FBZixDQUF1QmxCLGFBQWEsSUFB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QkFWVjtBQVdMbkMsSUFBQUEsZUFBZSxFQUFFb0MseUJBWFo7QUFZTG5DLElBQUFBLGNBQWMsRUFBRW9DLHdCQVpYO0FBYUxuQyxJQUFBQSxnQkFBZ0IsRUFBRW9DLDBCQWJiO0FBY0xuQyxJQUFBQSxlQUFlLEVBQUVvQyx5QkFkWjtBQWVMbkMsSUFBQUEsT0FBTyxFQUFFb0MsaUJBZko7QUFnQkxuQyxJQUFBQSxNQUFNLEVBQUVvQyxnQkFoQkgsRUFBUDs7QUFrQkQsQ0F4REQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgQUVTID0gcmVxdWlyZSgnYWVzLWpzJylcbmNvbnN0IGdlbkFFU0tleSA9IHJlcXVpcmUoJy4vZ2VuX2Flc19rZXknKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIChzdHJhdGVneSwgcGFzc3dvcmQpID0+IHtcbiAgY29uc3Qge1xuICAgIGlkLCBsYWJlbCwgZGVmaW5lSW5kaWNhdG9ycywgb25QcmljZVVwZGF0ZSwgb25FbnRlciwgb25VcGRhdGUsIG9uVXBkYXRlTG9uZyxcbiAgICBvblVwZGF0ZVNob3J0LCBvblVwZGF0ZUNsb3NpbmcsIG9uUG9zaXRpb25PcGVuLCBvblBvc2l0aW9uVXBkYXRlLFxuICAgIG9uUG9zaXRpb25DbG9zZSwgb25TdGFydCwgb25TdG9wXG4gIH0gPSBzdHJhdGVneVxuXG4gIGNvbnN0IGFlc0tleSA9IGF3YWl0IGdlbkFFU0tleShwYXNzd29yZClcbiAgY29uc3QgYWVzQ1RSID0gbmV3IEFFUy5Nb2RlT2ZPcGVyYXRpb24uY3RyKGFlc0tleSkgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIGNvbnN0IGxhYmVsQnl0ZXMgPSBBRVMudXRpbHMudXRmOC50b0J5dGVzKGxhYmVsIHx8ICcnKVxuICBjb25zdCBkZWZpbmVJbmRpY2F0b3JzQnl0ZXMgPSBBRVMudXRpbHMudXRmOC50b0J5dGVzKGRlZmluZUluZGljYXRvcnMgfHwgJycpXG4gIGNvbnN0IG9uUHJpY2VVcGRhdGVCeXRlcyA9IEFFUy51dGlscy51dGY4LnRvQnl0ZXMob25QcmljZVVwZGF0ZSB8fCAnJylcbiAgY29uc3Qgb25FbnRlckJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvbkVudGVyIHx8ICcnKVxuICBjb25zdCBvblVwZGF0ZUJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvblVwZGF0ZSB8fCAnJylcbiAgY29uc3Qgb25VcGRhdGVMb25nQnl0ZXMgPSBBRVMudXRpbHMudXRmOC50b0J5dGVzKG9uVXBkYXRlTG9uZyB8fCAnJylcbiAgY29uc3Qgb25VcGRhdGVTaG9ydEJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvblVwZGF0ZVNob3J0IHx8ICcnKVxuICBjb25zdCBvblVwZGF0ZUNsb3NpbmdCeXRlcyA9IEFFUy51dGlscy51dGY4LnRvQnl0ZXMob25VcGRhdGVDbG9zaW5nIHx8ICcnKVxuICBjb25zdCBvblBvc2l0aW9uT3BlbkJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvblBvc2l0aW9uT3BlbiB8fCAnJylcbiAgY29uc3Qgb25Qb3NpdGlvblVwZGF0ZUJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvblBvc2l0aW9uVXBkYXRlIHx8ICcnKVxuICBjb25zdCBvblBvc2l0aW9uQ2xvc2VCeXRlcyA9IEFFUy51dGlscy51dGY4LnRvQnl0ZXMob25Qb3NpdGlvbkNsb3NlIHx8ICcnKVxuICBjb25zdCBvblN0YXJ0Qnl0ZXMgPSBBRVMudXRpbHMudXRmOC50b0J5dGVzKG9uU3RhcnQgfHwgJycpXG4gIGNvbnN0IG9uU3RvcEJ5dGVzID0gQUVTLnV0aWxzLnV0ZjgudG9CeXRlcyhvblN0b3AgfHwgJycpXG5cbiAgY29uc3QgbGFiZWxDaXBoZXJUZXh0ID0gQUVTLnV0aWxzLmhleC5mcm9tQnl0ZXMoYWVzQ1RSLmVuY3J5cHQobGFiZWxCeXRlcykpXG4gIGNvbnN0IGRlZmluZUluZGljYXRvcnNDaXBoZXJUZXh0ID0gQUVTLnV0aWxzLmhleC5mcm9tQnl0ZXMoYWVzQ1RSLmVuY3J5cHQoZGVmaW5lSW5kaWNhdG9yc0J5dGVzKSlcbiAgY29uc3Qgb25QcmljZVVwZGF0ZUNpcGhlclRleHQgPSBBRVMudXRpbHMuaGV4LmZyb21CeXRlcyhhZXNDVFIuZW5jcnlwdChvblByaWNlVXBkYXRlQnl0ZXMpKVxuICBjb25zdCBvbkVudGVyQ2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uRW50ZXJCeXRlcykpXG4gIGNvbnN0IG9uVXBkYXRlQ2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uVXBkYXRlQnl0ZXMpKVxuICBjb25zdCBvblVwZGF0ZUxvbmdDaXBoZXJUZXh0ID0gQUVTLnV0aWxzLmhleC5mcm9tQnl0ZXMoYWVzQ1RSLmVuY3J5cHQob25VcGRhdGVMb25nQnl0ZXMpKVxuICBjb25zdCBvblVwZGF0ZVNob3J0Q2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uVXBkYXRlU2hvcnRCeXRlcykpXG4gIGNvbnN0IG9uVXBkYXRlQ2xvc2luZ0NpcGhlclRleHQgPSBBRVMudXRpbHMuaGV4LmZyb21CeXRlcyhhZXNDVFIuZW5jcnlwdChvblVwZGF0ZUNsb3NpbmdCeXRlcykpXG4gIGNvbnN0IG9uUG9zaXRpb25PcGVuQ2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uUG9zaXRpb25PcGVuQnl0ZXMpKVxuICBjb25zdCBvblBvc2l0aW9uVXBkYXRlQ2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uUG9zaXRpb25VcGRhdGVCeXRlcykpXG4gIGNvbnN0IG9uUG9zaXRpb25DbG9zZUNpcGhlclRleHQgPSBBRVMudXRpbHMuaGV4LmZyb21CeXRlcyhhZXNDVFIuZW5jcnlwdChvblBvc2l0aW9uQ2xvc2VCeXRlcykpXG4gIGNvbnN0IG9uU3RhcnRDaXBoZXJUZXh0ID0gQUVTLnV0aWxzLmhleC5mcm9tQnl0ZXMoYWVzQ1RSLmVuY3J5cHQob25TdGFydEJ5dGVzKSlcbiAgY29uc3Qgb25TdG9wQ2lwaGVyVGV4dCA9IEFFUy51dGlscy5oZXguZnJvbUJ5dGVzKGFlc0NUUi5lbmNyeXB0KG9uU3RvcEJ5dGVzKSlcblxuICByZXR1cm4ge1xuICAgIGlkLFxuICAgIGxhYmVsLFxuICAgIGNyeXB0ZWRMYWJlbDogbGFiZWxDaXBoZXJUZXh0LFxuXG4gICAgZGVmaW5lSW5kaWNhdG9yczogZGVmaW5lSW5kaWNhdG9yc0NpcGhlclRleHQsXG4gICAgb25QcmljZVVwZGF0ZTogb25QcmljZVVwZGF0ZUNpcGhlclRleHQsXG4gICAgb25FbnRlcjogb25FbnRlckNpcGhlclRleHQsXG4gICAgb25VcGRhdGU6IG9uVXBkYXRlQ2lwaGVyVGV4dCxcbiAgICBvblVwZGF0ZUxvbmc6IG9uVXBkYXRlTG9uZ0NpcGhlclRleHQsXG4gICAgb25VcGRhdGVTaG9ydDogb25VcGRhdGVTaG9ydENpcGhlclRleHQsXG4gICAgb25VcGRhdGVDbG9zaW5nOiBvblVwZGF0ZUNsb3NpbmdDaXBoZXJUZXh0LFxuICAgIG9uUG9zaXRpb25PcGVuOiBvblBvc2l0aW9uT3BlbkNpcGhlclRleHQsXG4gICAgb25Qb3NpdGlvblVwZGF0ZTogb25Qb3NpdGlvblVwZGF0ZUNpcGhlclRleHQsXG4gICAgb25Qb3NpdGlvbkNsb3NlOiBvblBvc2l0aW9uQ2xvc2VDaXBoZXJUZXh0LFxuICAgIG9uU3RhcnQ6IG9uU3RhcnRDaXBoZXJUZXh0LFxuICAgIG9uU3RvcDogb25TdG9wQ2lwaGVyVGV4dFxuICB9XG59XG4iXX0=