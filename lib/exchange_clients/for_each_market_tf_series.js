'use strict';

const PI = require('p-iteration');

module.exports = async (db, EXA, cb) => {
  const { Market } = db;
  const markets = await Market.find([['exchange', '=', EXA.id]]);
  const tfs = EXA.getCandleTimeFrames();

  await PI.forEachSeries(markets, async market => {
    await PI.forEachSeries(tfs, async tf => {
      return cb(market, tf);
    });
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9leGNoYW5nZV9jbGllbnRzL2Zvcl9lYWNoX21hcmtldF90Zl9zZXJpZXMuanMiXSwibmFtZXMiOlsiUEkiLCJyZXF1aXJlIiwibW9kdWxlIiwiZXhwb3J0cyIsImRiIiwiRVhBIiwiY2IiLCJNYXJrZXQiLCJtYXJrZXRzIiwiZmluZCIsImlkIiwidGZzIiwiZ2V0Q2FuZGxlVGltZUZyYW1lcyIsImZvckVhY2hTZXJpZXMiLCJtYXJrZXQiLCJ0ZiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUFsQjs7QUFFQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCLE9BQU9DLEVBQVAsRUFBV0MsR0FBWCxFQUFnQkMsRUFBaEIsS0FBdUI7QUFDdEMsUUFBTSxFQUFFQyxNQUFGLEtBQWFILEVBQW5CO0FBQ0EsUUFBTUksT0FBTyxHQUFHLE1BQU1ELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLENBQUMsQ0FBQyxVQUFELEVBQWEsR0FBYixFQUFrQkosR0FBRyxDQUFDSyxFQUF0QixDQUFELENBQVosQ0FBdEI7QUFDQSxRQUFNQyxHQUFHLEdBQUdOLEdBQUcsQ0FBQ08sbUJBQUosRUFBWjs7QUFFQSxRQUFNWixFQUFFLENBQUNhLGFBQUgsQ0FBaUJMLE9BQWpCLEVBQTBCLE1BQU9NLE1BQVAsSUFBa0I7QUFDaEQsVUFBTWQsRUFBRSxDQUFDYSxhQUFILENBQWlCRixHQUFqQixFQUFzQixNQUFPSSxFQUFQLElBQWM7QUFDeEMsYUFBT1QsRUFBRSxDQUFDUSxNQUFELEVBQVNDLEVBQVQsQ0FBVDtBQUNELEtBRkssQ0FBTjtBQUdELEdBSkssQ0FBTjtBQUtELENBVkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgUEkgPSByZXF1aXJlKCdwLWl0ZXJhdGlvbicpXG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKGRiLCBFWEEsIGNiKSA9PiB7XG4gIGNvbnN0IHsgTWFya2V0IH0gPSBkYlxuICBjb25zdCBtYXJrZXRzID0gYXdhaXQgTWFya2V0LmZpbmQoW1snZXhjaGFuZ2UnLCAnPScsIEVYQS5pZF1dKVxuICBjb25zdCB0ZnMgPSBFWEEuZ2V0Q2FuZGxlVGltZUZyYW1lcygpXG5cbiAgYXdhaXQgUEkuZm9yRWFjaFNlcmllcyhtYXJrZXRzLCBhc3luYyAobWFya2V0KSA9PiB7XG4gICAgYXdhaXQgUEkuZm9yRWFjaFNlcmllcyh0ZnMsIGFzeW5jICh0ZikgPT4ge1xuICAgICAgcmV0dXJuIGNiKG1hcmtldCwgdGYpXG4gICAgfSlcbiAgfSlcbn1cbiJdfQ==